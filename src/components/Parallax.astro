---
import i18next from "../i18n/config";

const { lang = "hr" } = Astro.params;

// Change language before rendering
if (lang) {
    await i18next.changeLanguage(lang);
}

// Pre-render translations
const parallaxTitle = i18next.t("parallax.title");
const parallaxDescription = i18next.t("parallax.description");

const services = [
    {
        title: i18next.t("services.project1.title"),
        description: i18next.t("services.project1.description"),
        image: "https://storage.googleapis.com/msgsndr/M4krpnwvjmupM7QGr4NX/media/67b2aaa22de3ab45eb9d0b31.png",
        alt: "INSTALACIJA SOLARNE ENERGIJE",
    },
    {
        title: i18next.t("services.project2.title"),
        description: i18next.t("services.project2.description"),
        image: "https://images.unsplash.com/photo-1566093097221-ac2335b09e70?ixlib=rb-4.0.3&q=85&fm=jpg&crop=entropy&cs=srgb&w=800",
        alt: "Solarna energija za poslovanje",
    },
    {
        title: i18next.t("services.project3.title"),
        description: i18next.t("services.project3.description"),
        image: "https://images.unsplash.com/photo-1454165804606-c3d57bc86b40?ixlib=rb-4.0.3&q=85&fm=jpg&crop=entropy&cs=srgb&w=800",
        alt: "Servis solarnih panela",
    },
    {
        title: i18next.t("services.project4.title"),
        description: i18next.t("services.project4.description"),
        image: "https://storage.googleapis.com/msgsndr/M4krpnwvjmupM7QGr4NX/media/67b2a91fafe6ae4deaaa5ebe.png",
        alt: "Solarna rješenja za vaš krov",
    },
];
---

<section id="services" class="relative">
    <!-- Parallax Header Section -->
    <div class="relative h-[60vh] overflow-hidden">
        <!-- Background container with image -->
        <div
            class="absolute inset-0 bg-cover bg-center bg-no-repeat parallax-bg"
            style="background-image: url('https://assets.cdn.filesafe.space/M4krpnwvjmupM7QGr4NX/media/674e160afd605f8a46bfa5c9.png');">
        </div>
        <div
            class="absolute inset-0 bg-gradient-to-r from-black/80 via-black/60 to-black/80">
        </div>

        <div
            class="relative h-full max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 flex items-center">
            <div class="w-full">
                <!-- Content -->
                <div class="text-center max-w-3xl mx-auto">
                    <h2 class="text-4xl md:text-5xl font-bold text-white mb-6">
                        {parallaxTitle}
                    </h2>
                    <p class="text-xl text-gray-200 mb-8 leading-relaxed">
                        {parallaxDescription}
                    </p>
                </div>
            </div>
        </div>
    </div>

    <!-- Projects Showcase Section -->
    <div class="bg-gradient-to-b from-gray-100 to-gray-200 py-20">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="space-y-20">
                {
                    services.map((service, index) => (
                        <div class="grid md:grid-cols-2 gap-12 items-center">
                            <div
                                class={`${index % 2 === 1 ? "md:order-2" : ""}`}>
                                <img
                                    src={service.image}
                                    alt={service.alt}
                                    class="w-full h-auto rounded-lg shadow-xl hover:scale-[1.02] transition-transform"
                                    loading={index <= 1 ? "eager" : "lazy"}
                                />
                            </div>
                            <div class={index % 2 === 1 ? "md:order-1" : ""}>
                                <h3 class="text-3xl font-bold text-primary mb-4">
                                    {service.title}
                                </h3>
                                <p class="text-gray-600 text-lg">
                                    {service.description}
                                </p>
                            </div>
                        </div>
                    ))
                }
            </div>
        </div>
    </div>
</section>

<style>
    .parallax-bg {
        background-attachment: fixed;
    }

    @media (max-width: 768px) {
        .parallax-bg {
            background-attachment: scroll;
        }

        h2 {
            font-size: 2rem;
            line-height: 1.2;
        }

        p {
            font-size: 1rem;
        }
    }
</style>
